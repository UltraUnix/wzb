geschlecht$gesamt   <- NULL
geschlecht$mann     <- NULL
geschlecht[, 1]     <- iconv(geschlecht$gemeinde , "windows-1252" , "utf-8")
geschlecht[, 1]     <- gsub(", Stadt" , "" , geschlecht$gemeinde)
geschlecht[, 1]     <- gsub("      " , "" , geschlecht$gemeinde)
geschlecht[383 , 1] <- "Leipzig, Stadt"
btw13               <- merge(btw13 , geschlecht , by="gemeinde" , all.x = TRUE )
#Von Mikrozensus 2011
btw13$mannanteil[98]  <- 49.63949 # Erlbach
btw13$mannanteil[182] <- 51.26582 # Ketzerbachtal
btw13$mannanteil[210] <- 48.83146 # Lengefeld
btw13$mannanteil[212] <- 49.75195 # Leuben-Schleinitz
btw13$mannanteil[309] <- 49.64912 # Pockau
btw13$mannanteil[363] <- 51.13305 # Schmiedeberg
btw13$mannanteil[373] <- 50.91308 # Sohland a. Rotstein
#Arbeitslosigkeit
#----------------
arbeitslose          <- read.table("C:/Users/User/Documents/Konferenzen/DVPW 2015/Arbeitspapier/arbeitslose.csv", header = TRUE , sep = ";")
arbeitslose$gemeinde <- iconv(arbeitslose$gemeinde ,  "windows-1252" , "utf-8")
arbeitslose[, 1]     <- gsub(", Stadt" , "" , arbeitslose$gemeinde)
arbeitslose$gemeinde <- substring(arbeitslose$gemeinde , 2 , nchar(arbeitslose$gemeinde))
arbeitslose[374 , 1] <- "Leipzig, Stadt"
btw13                <- merge(btw13 , arbeitslose , by ="gemeinde" , all.x = TRUE)
# Altersgruppen 18-65
library(reshape)
alter               <- read.table("C:/Users/User/Documents/Konferenzen/DVPW 2015/Arbeitspapier/alter.csv",
header = TRUE , sep = ";")
alter               <- alter[alter$gruppen != "Insgesamt" & alter$gruppen != "unter 3 Jahre"
& alter$gruppen != "3 bis unter 6 Jahre",]
alter               <- alter[alter$gruppen != "6 bis unter 10 Jahre" & alter$gruppen != "10 bis unter 15 Jahre"
& alter$gruppen != "15 bis unter 18 Jahre",]
alter               <- alter[alter$gruppen != "65 bis unter 75 Jahre" & alter$gruppen != "75 Jahre und mehr",]
alter               <- reshape::cast(alter, gemeinde ~ gruppen , sum)
alter$alter         <- rowSums(alter[,c(2:11)])
alter               <- data.frame(gemeinde = alter[,1] , alter = alter[,12])[c(1:432),]
alter[, 1]          <- gsub(", Stadt" , "" , alter$gemeinde)
alter[, 1]          <- gsub("      "  , "" , alter$gemeinde)
alter[203 , 1]      <- "Leipzig, Stadt"
alter[150 , 1]      <- "Hartmannsdorf"
alter[30 , 1]       <- "Bernsdorf"
alter[31 , 1]       <- "Bernsdorf/O.L."
alter[298 , 1]      <- "Pausa-Mühltroff"
alter[9 , 1]        <- "Auerbach"
alter[209 , 1]      <- "Lichtenberg"
alter[266 , 1]      <- "Neustadt i. Sa."
alter[84 , 1]      <-  "Ebersbach (bei Großenhain)"
alter[, 1]          <- iconv(alter$gemeinde , "windows-1252" , "utf-8")
btw13 <- merge(btw13 , alter , by = "gemeinde" , all.x = TRUE)
# Näherungsweise Gesamtbevölkerung verwendet
btw13[98 , 17]  <- 1729  # Erlbach
btw13[182 , 17] <- 2587  # Ketzerbachtal
btw13[210 , 17] <- 4375  # Lengefeld
btw13[212 , 17] <- 1336  # Leuben-Schleinitz
btw13[309 , 17] <- 3926  # Pockau
btw13[363 , 17] <- 4502  # Schmiedeberg
btw13[373 , 17] <- 1324  # Sohland a. Rotstein
btw13$arbeitslos <- btw13$arbeitslos/btw13$alter*100
btw13$alter      <- NULL
#Verbindung mit Raumdaten
#------------------------
btw13_name     <- btw13[,1:2]
name_id        <- gemeinden@data[,1:2] ; name_id[,1] <- iconv(name_id[,1] , "windows-1252", "utf-8")
name_id_merge  <- merge(btw13_name , name_id , by.y = "name" , by.x = "gemeinde" , all.x = TRUE)
write.table(name_id_merge , "C:/Users/user/Desktop/names.csv" , sep =  ";")
name_id        <- read.table("C:/Users/User/Documents/Konferenzen/DVPW 2015/Arbeitspapier/names.csv", header = TRUE , sep = ";")
btw13          <- merge(btw13 , name_id , by = "gemeinde")
gemeinden_klein <- merge(gemeinden , btw13 , by = "id")
gemeinden_klein <- gemeinden_klein[!is.na (gemeinden_klein@data$zweit_npd_2013) ,]
#Unmerged
#gemeinden_alt <- gemeinden_klein[is.na (gemeinden_klein@data$zweit_npd_2013) ,]
library(plyr)
library(rCharts)
library(rMaps)
library(gdata)
library(data.table)
library(rgdal)
library(reshape)
# Daten einlesen und vorbereiten
btw0509     <- read.xls("C:/Users/User/Documents/Projekte und Veröffentlichungen/Masterarbeit/Datensatz/Datensatz_Sachsen.xlsx" ,
header = TRUE )
btw0509     <- data.frame(gemeinde = btw0509[,1] , zweit_npd_2009 = round(as.numeric(as.character(btw0509[,2])) , 1) ,
zweit_npd_2005 = round(as.numeric(as.character(btw0509[,3])) , 1))
btw0509$gemeinde <- gsub(", Stadt" , "" , btw0509$gemeinde)
#write.table(btw0509 , "C:/Users/User/Documents/Konferenzen/DVPW 2015/Referat/btw0509.csv" , sep = ";")
# Bundestagswahlen 2005 und 2009 mit Daten von 2013 verbinden
btw0509          <- read.table("C:/Users/User/Documents/Konferenzen/DVPW 2015/Referat/btw0509.csv" , sep = ";" , header = TRUE)
btw0509$gemeinde <- as.character(btw0509[,1])
btw0509$gemeinde <- iconv(btw0509$gemeinde , "windows-1252" , "utf-8")
btw13m      <- data.frame(gemeinde = btw13[,1] , zweit_npd_2013 = btw13[,2])
btw13m      <- merge(btw13m , btw0509 , by = "gemeinde")
#Mit Raumdaten verbinden
gemeinden        <- readOGR("C:/Users/User/Documents/Projekte und Veröffentlichungen/Masterarbeit/Datensatz/Karten/Gemeinden" , "Gemeinden")
name_id          <- read.table("C:/Users/User/Documents/Konferenzen/DVPW 2015/Arbeitspapier/names.csv", header = TRUE , sep = ";")
btw13m           <- merge(btw13m , name_id , by = "gemeinde")
gemeinden_ichoro <- merge(gemeinden , btw13m , by = "id")
gemeinden_ichoro <- as.data.table(gemeinden_ichoro@data)
gemeinden_ichoro[,(3:11):=NULL]; gemeinden_ichoro <- as.data.frame(gemeinden_ichoro) #mehrere Spalten löschen
#Fehlende Daten auffüllen
gemeinden_ichoro[33 , (4:6)]  <- c(4.2 , 4.8 , 5.6) #Lauter-Bernsbach
gemeinden_ichoro[37 , (4:6)]  <- c(3.3 , 5.9 , 5.9)
gemeinden_ichoro[42 , (4:6)]  <- c(3.9 , 4.4 , 5.2) #Leisnig
gemeinden_ichoro[55 , (4:6)]  <- c(2.9 , 2.8 , 4.3) #Weischlitz
gemeinden_ichoro[65 , (4:6)]  <- c(3.2 , 5.0 , 6.1) #Schirgiswalde-Kirschau
gemeinden_ichoro[90 , (4:6)]  <- c(3.6 , 7.9 , 8.5) #Döbeln
gemeinden_ichoro[107 , (4:6)] <- c(3.7 , 5.4 , 5.1) #Lugau
gemeinden_ichoro[109 , (4:6)] <- c(3.2 , 3.5 , 4.9) #Flöha
gemeinden_ichoro[114 , (4:6)] <- c(4.7 , 5.8 , 7.5) #Oederan
gemeinden_ichoro[122 , (4:6)] <- c(6.5 , 9.2 , 8.5) #Altenberg
gemeinden_ichoro[144 , (4:6)] <- c(3.3 , 2.4 , 3.3) #Herrnhut
gemeinden_ichoro[154 , (4:6)] <- c(3.1 , 4.1 , 6.3) #Beilrode
gemeinden_ichoro[159 , (4:6)] <- c(4.8 , 5.5 , 8.5) #Malschwitz
gemeinden_ichoro[175 , (4:6)] <- c(5.2 , 4.7 , 4.8) #Bobritzsch-Hilbersdorf
gemeinden_ichoro[180 , (4:6)] <- c(3.6 , 5.2 , 4.9) #Lossatal
gemeinden_ichoro[186 , (4:6)] <- c(3.6 , 4.5 , 3.6) #Zwönitz
gemeinden_ichoro[197 , (4:6)] <- c(8.1 , 10.6 , 11.9) #Sebnitz
gemeinden_ichoro[198 , (4:6)] <- c(3.2 , 4.8 , 7.2) #Schirgiswald-Kirschau
gemeinden_ichoro[199 , (4:6)] <- c(1.9 , 3.0 , 4.4) #Pegau
gemeinden_ichoro[259 , (4:6)] <- c(3.7 , 6.2 , 4.9) #Rosenbach
gemeinden_ichoro[272 , (4:6)] <- c(3.0 , 3.4 , 3.6) #Pausa-Mühltroff
gemeinden_ichoro[276 , (4:6)] <- c(3.8 , 8.3 , 8.6) #Grimma
gemeinden_ichoro[281 , (4:6)] <- c(5.6 , 7.7 , 12.8) #Gröditz
gemeinden_ichoro[287 , (4:6)] <- c(4.7 , 6.1 , 8.5) #Ebersbach-Neugersdorf
gemeinden_ichoro[294 , (4:6)] <- c(3.8 , 4.2 , 3.5) #Wiedemar
gemeinden_ichoro[300 , (4:6)] <- c(3.7 , 7.8 , 8.6) #Kottmar
gemeinden_ichoro[303 , (4:6)] <- c(3.9 , 5.2 , 5.5) #Roßwein
gemeinden_ichoro[309 , (4:6)] <- c(3.7 , 5.5 , 6.4) #Kottmar
gemeinden_ichoro[338 , (4:6)] <- c(4.1 , 4.2 , 6.6) #Marienberg
gemeinden_ichoro[341 , (4:6)] <- c(6.1 , 7.6 , 8.3) #Bad Schandau
gemeinden_ichoro[342 , (4:6)] <- c(5.6 , 6.2 , 8.1) #Klingenberg
gemeinden_ichoro[381 , (4:6)] <- c(5.5 , 7.3 , 8.0) #Belgern-Schildau
gemeinden_ichoro[406 , (4:6)] <- c(4.6 , 5.4 , 6.9) #Mügeln
gemeinden_ichoro[407 , (4:6)] <- c(3.3 , 3.1 , 5.1) #Eibenstock
gemeinden_ichoro[420 , (4:6)] <- c(3.7 , 4.1 , 4.0) #Mügeln
gemeinden_ichoro[438 , (4:6)] <- c(4.4 , 6.9 , 8.2) #Klipphausen
gemeinden_ichoro[451 , (4:6)] <- c(9.8 , 12.5 , 14.1) #Lampertswalde
gemeinden_ichoro[458 , (4:6)] <- c(5.0 , 7.6 , 8.0) #Bernsdorf/O.L.
gemeinden_ichoro[469 , (4:6)] <- c(3.9 , 6.6 , 6.7) #Döbeln und Waldheim (Mittelwert)
gemeinden_ichoro[470 , (4:6)] <- c(3.9 , 7.7 , 7.8) #Torgau
gemeinden_ichoro[472 , (4:6)] <- c(4.1 , 5.0 , 7.0) #Marienberg
gemeinden_ichoro[479 , (4:6)] <- c(3.8 , 3.0 , 4.7) #Wiedemar
gemeinden_ichoro[481 , (4:6)] <- c(2.9 , 3.7 , 4.2) #Klingenthal
gemeinden_ichoro[356 , 6 ] <- 7.5 #Mittelwert Raschau und Markersbach
gemeinden_ichoro$gemeinde <- as.character(gemeinden_ichoro$gemeinde)
gemeinden_ichoro$name     <- as.character(gemeinden_ichoro$name)
gemeinden_ichoro$gemeinde[is.na(gemeinden_ichoro$gemeinde)==TRUE] <- gemeinden_ichoro$name[is.na(gemeinden_ichoro$gemeinde)==TRUE]
gemeinden_ichoro[144 , 3] <- "Großhennersdorf"
gemeinden_ichoro[154 , 3] <- "Großtreben-Zwethau"
gemeinden_ichoro[406 , 3] <- "Sornzig-Ablaß"
gemeinden_ichoro[451 , 3] <- "Weißig am Raschütz"
#gemeinden_ichoro$zweit_npd_2013 <-cut(gemeinden_ichoro$zweit_npd_2013 , breaks=c(1.0,2.5,4.9,6.5,8.0,9.5))
gemeinden_ichoro_stack          <-  gemeinden_ichoro
gemeinden_ichoro_stack$name     <-  NULL
gemeinden_ichoro_stack          <-  reshape::melt(gemeinden_ichoro_stack , id=c("id" , "gemeinde"))
gemeinden_ichoro_stack$variable <-  factor(gemeinden_ichoro_stack$variable , labels=c("2013" , "2009" , "2005"))
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , year = variable)
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , anteil = value)
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , name = gemeinde)
gemeinden_ichoro_stack$year     <-  as.integer(as.character(gemeinden_ichoro_stack$year))
gemeinden_ichoro_stack          <-  gemeinden_ichoro_stack[order(gemeinden_ichoro_stack$name),]
#Darstellung auf der Karte
d1 <- ichoropleth(anteil ~ id , data = gemeinden_ichoro_stack , pal = 'YlOrRd' , ncuts = 5, map = "state" , animate = "year" , play = F)
d1$set(
geographyConfig = list(
dataUrl = "https://dl.dropboxusercontent.com/u/94863207/Gemeinden.json" ,
popupTemplate =  "#! function(geography, data) {
return '<div class=hoverinfo>' + geography.properties.name + ' Zweitstimmenanteil: ' +
data.anteil+ ' Prozent' + ' ';
}  !#"
),
scope = 'states', height = 600 , width = 900 ,
setProjection = '#! function( element, options ) {
var projection, path;
projection = d3.geo.mercator()
.center([14, 51]).scale(10000)
.translate([element.offsetWidth / 2, element.offsetHeight / 2]);
path = d3.geo.path().projection( projection );
return {path: path, projection: projection};
} !#'
)
d1
setwd("C:/Users/User/Documents/Konferenzen/DVPW 2015/Referat")
sink("map.txt")
d1$show("inline" , include_assets = TRUE , cdn = TRUE)
d1 <- ichoropleth(anteil ~ id , data = gemeinden_ichoro_stack , pal = 'YlOrRd' , ncuts = 5, map = "state" , animate = "year" , play = F)
d1$set(
geographyConfig = list(
dataUrl = "https://dl.dropboxusercontent.com/u/94863207/Gemeinden.json"
),
scope = 'states',
setProjection = '#! function( element, options ) {
var projection, path;
projection = d3.geo.mercator()
.center([14, 51]).scale(element.offsetWidth)
.translate([element.offsetWidth / 2, element.offsetHeight / 2]);
path = d3.geo.path().projection( projection );
return {path: path, projection: projection};
} !#'
)
d1
d1 <- ichoropleth(anteil ~ id , data = gemeinden_ichoro_stack , pal = 'YlOrRd' , ncuts = 5, map = "state" , animate = "year" , play = F)
d1$set(
geographyConfig = list(
dataUrl = "https://dl.dropboxusercontent.com/u/94863207/Gemeinden.json"
),
scope = 'states',
setProjection = '#! function( element, options ) {
var projection, path;
projection = d3.geo.mercator()
.center([14, 51]).scale(10000)
.translate([element.offsetWidth / 2, element.offsetHeight / 2]);
path = d3.geo.path().projection( projection );
return {path: path, projection: projection};
} !#'
)
d1
gemeinden_ichoro_stack          <-  gemeinden_ichoro
gemeinden_ichoro_stack$name     <-  NULL
gemeinden_ichoro_stack          <-  reshape::melt(gemeinden_ichoro_stack , id=c("id" , "gemeinde"))
gemeinden_ichoro_stack$variable <-  factor(gemeinden_ichoro_stack$variable , labels=c("2013" , "2012" , "2011"))
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , year = variable)
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , anteil = value)
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , name = gemeinde)
gemeinden_ichoro_stack$year     <-  as.integer(as.character(gemeinden_ichoro_stack$year))
gemeinden_ichoro_stack          <-  gemeinden_ichoro_stack[order(gemeinden_ichoro_stack$name),]
#Darstellung auf der Karte
d1 <- ichoropleth(anteil ~ id , data = gemeinden_ichoro_stack , pal = 'YlOrRd' , ncuts = 5, map = "state" , animate = "year" , play = F)
d1$set(
geographyConfig = list(
dataUrl = "https://dl.dropboxusercontent.com/u/94863207/Gemeinden.json"
),
scope = 'states',
setProjection = '#! function( element, options ) {
var projection, path;
projection = d3.geo.mercator()
.center([14, 51]).scale(10000)
.translate([element.offsetWidth / 2, element.offsetHeight / 2]);
path = d3.geo.path().projection( projection );
return {path: path, projection: projection};
} !#'
)
d1
d1 <- ichoropleth(anteil ~ id , data = gemeinden_ichoro_stack , pal = 'YlOrRd' , ncuts = 5, map = "state" , animate = "year" , play = F)
d1$set(
geographyConfig = list(
dataUrl = "https://dl.dropboxusercontent.com/u/94863207/Gemeinden.json" ,
popupTemplate =  "#! function(geography, data) {
return '<div class=hoverinfo>' + geography.properties.name + ' Zweitstimmenanteil: ' +
data.anteil+ ' Prozent' + ' ';
}  !#"
),
scope = 'states', height = 600 , width = 900 ,
setProjection = '#! function( element, options ) {
var projection, path;
projection = d3.geo.mercator()
.center([14, 51]).scale(10000)
.translate([element.offsetWidth / 2, element.offsetHeight / 2]);
path = d3.geo.path().projection( projection );
return {path: path, projection: projection};
} !#'
)
d1
setwd("C:/Users/User/Documents/Konferenzen/DVPW 2015/Referat")
sink("map.txt")
d1$show("inline" , include_assets = TRUE , cdn = TRUE)
sink()
ih
?sink
View(gemeinden_ichoro_stack)
gemeinden_ichoro_stack          <-  gemeinden_ichoro
gemeinden_ichoro_stack$name     <-  NULL
gemeinden_ichoro_stack$zweit_npd_2005 <- NULL
gemeinden_ichoro_stack          <-  reshape::melt(gemeinden_ichoro_stack , id=c("id" , "gemeinde"))
gemeinden_ichoro_stack$variable <-  factor(gemeinden_ichoro_stack$variable , labels=c("2013" , "2009"))
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , year = variable)
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , anteil = value)
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , name = gemeinde)
gemeinden_ichoro_stack$year     <-  as.integer(as.character(gemeinden_ichoro_stack$year))
View(gemeinden_ichoro_stack)
d1 <- ichoropleth(anteil ~ id , data = gemeinden_ichoro_stack , pal = 'YlOrRd' , ncuts = 5, map = "state" , animate = "year" , play = F)
d1$set(
geographyConfig = list(
dataUrl = "https://dl.dropboxusercontent.com/u/94863207/Gemeinden.json" ,
popupTemplate =  "#! function(geography, data) {
return '<div class=hoverinfo>' + geography.properties.name + ' Zweitstimmenanteil: ' +
data.anteil+ ' Prozent' + ' ';
}  !#"
),
scope = 'states', height = 600 , width = 900 ,
setProjection = '#! function( element, options ) {
var projection, path;
projection = d3.geo.mercator()
.center([14, 51]).scale(10000)
.translate([element.offsetWidth / 2, element.offsetHeight / 2]);
path = d3.geo.path().projection( projection );
return {path: path, projection: projection};
} !#'
)
d1
gemeinden_ichoro_stack$id       <-  as.character(gemeinden_ichoro_stack$id)
gemeinden_ichoro_stack          <-  gemeinden_ichoro
gemeinden_ichoro_stack$name     <-  NULL
gemeinden_ichoro_stack          <-  reshape::melt(gemeinden_ichoro_stack , id=c("id" , "gemeinde"))
gemeinden_ichoro_stack$variable <-  factor(gemeinden_ichoro_stack$variable , labels=c("2013" , "2009" , "2005"))
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , year = variable)
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , anteil = value)
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , name = gemeinde)
gemeinden_ichoro_stack$year     <-  as.integer(as.character(gemeinden_ichoro_stack$year))
gemeinden_ichoro_stack$id       <-  as.character(gemeinden_ichoro_stack$id)
gemeinden_ichoro_stack          <-  gemeinden_ichoro_stack[order(gemeinden_ichoro_stack$name),]
#Darstellung auf der Karte
d1 <- ichoropleth(anteil ~ id , data = gemeinden_ichoro_stack , pal = 'YlOrRd' , ncuts = 5, map = "state" , animate = "year" , play = F)
d1$set(
geographyConfig = list(
dataUrl = "https://dl.dropboxusercontent.com/u/94863207/Gemeinden.json" ,
popupTemplate =  "#! function(geography, data) {
return '<div class=hoverinfo>' + geography.properties.name + ' Zweitstimmenanteil: ' +
data.anteil+ ' Prozent' + ' ';
}  !#"
),
scope = 'states', height = 600 , width = 900 ,
setProjection = '#! function( element, options ) {
var projection, path;
projection = d3.geo.mercator()
.center([14, 51]).scale(10000)
.translate([element.offsetWidth / 2, element.offsetHeight / 2]);
path = d3.geo.path().projection( projection );
return {path: path, projection: projection};
} !#'
)
d1
gemeinden_ichoro_stack$gemeinde <-  NULL
gemeinden_ichoro_stack          <-  gemeinden_ichoro
gemeinden_ichoro_stack$name     <-  NULL
gemeinden_ichoro_stack          <-  reshape::melt(gemeinden_ichoro_stack , id=c("id" , "gemeinde"))
gemeinden_ichoro_stack$variable <-  factor(gemeinden_ichoro_stack$variable , labels=c("2013" , "2009" , "2005"))
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , year = variable)
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , anteil = value)
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , name = gemeinde)
gemeinden_ichoro_stack$gemeinde <-  NULL
gemeinden_ichoro_stack$year     <-  as.integer(as.character(gemeinden_ichoro_stack$year))
gemeinden_ichoro_stack$id       <-  as.character(gemeinden_ichoro_stack$id)
gemeinden_ichoro_stack          <-  gemeinden_ichoro_stack[order(gemeinden_ichoro_stack$name),]
#Darstellung auf der Karte
d1 <- ichoropleth(anteil ~ id , data = gemeinden_ichoro_stack , pal = 'YlOrRd' , ncuts = 5, map = "state" , animate = "year" , play = F)
d1$set(
geographyConfig = list(
dataUrl = "https://dl.dropboxusercontent.com/u/94863207/Gemeinden.json" ,
popupTemplate =  "#! function(geography, data) {
return '<div class=hoverinfo>' + geography.properties.name + ' Zweitstimmenanteil: ' +
data.anteil+ ' Prozent' + ' ';
}  !#"
),
scope = 'states', height = 600 , width = 900 ,
setProjection = '#! function( element, options ) {
var projection, path;
projection = d3.geo.mercator()
.center([14, 51]).scale(10000)
.translate([element.offsetWidth / 2, element.offsetHeight / 2]);
path = d3.geo.path().projection( projection );
return {path: path, projection: projection};
} !#'
)
d1
gemeinden_ichoro_stack          <-  gemeinden_ichoro
gemeinden_ichoro_stack$name     <-  NULL
gemeinden_ichoro_stack          <-  reshape::melt(gemeinden_ichoro_stack , id=c("id" , "gemeinde"))
gemeinden_ichoro_stack$variable <-  factor(gemeinden_ichoro_stack$variable , labels=c("2013" , "2009" , "2005"))
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , year = variable)
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , anteil = value)
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , name = gemeinde)
gemeinden_ichoro_stack$name    <-  NULL
gemeinden_ichoro_stack$year     <-  as.integer(as.character(gemeinden_ichoro_stack$year))
gemeinden_ichoro_stack$id       <-  as.character(gemeinden_ichoro_stack$id)
gemeinden_ichoro_stack          <-  gemeinden_ichoro_stack[order(gemeinden_ichoro_stack$name),]
#Darstellung auf der Karte
d1 <- ichoropleth(anteil ~ id , data = gemeinden_ichoro_stack , pal = 'YlOrRd' , ncuts = 5, map = "state" , animate = "year" , play = F)
d1$set(
geographyConfig = list(
dataUrl = "https://dl.dropboxusercontent.com/u/94863207/Gemeinden.json" ,
popupTemplate =  "#! function(geography, data) {
return '<div class=hoverinfo>' + geography.properties.name + ' Zweitstimmenanteil: ' +
data.anteil+ ' Prozent' + ' ';
}  !#"
),
scope = 'states', height = 600 , width = 900 ,
setProjection = '#! function( element, options ) {
var projection, path;
projection = d3.geo.mercator()
.center([14, 51]).scale(10000)
.translate([element.offsetWidth / 2, element.offsetHeight / 2]);
path = d3.geo.path().projection( projection );
return {path: path, projection: projection};
} !#'
)
d1
gemeinden_ichoro_stack          <-  gemeinden_ichoro
gemeinden_ichoro_stack$name     <-  NULL
gemeinden_ichoro_stack          <-  reshape::melt(gemeinden_ichoro_stack , id=c("id" , "gemeinde"))
gemeinden_ichoro_stack$variable <-  factor(gemeinden_ichoro_stack$variable , labels=c("2013" , "2012" , "2011"))
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , year = variable)
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , anteil = value)
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , name = gemeinde)
gemeinden_ichoro_stack$name    <-  NULL
gemeinden_ichoro_stack$year     <-  as.integer(as.character(gemeinden_ichoro_stack$year))
gemeinden_ichoro_stack$id       <-  as.character(gemeinden_ichoro_stack$id)
gemeinden_ichoro_stack          <-  gemeinden_ichoro_stack[order(gemeinden_ichoro_stack$name),]
#Darstellung auf der Karte
d1 <- ichoropleth(anteil ~ id , data = gemeinden_ichoro_stack , pal = 'YlOrRd' , ncuts = 5, map = "state" , animate = "year" , play = F)
d1$set(
geographyConfig = list(
dataUrl = "https://dl.dropboxusercontent.com/u/94863207/Gemeinden.json" ,
popupTemplate =  "#! function(geography, data) {
return '<div class=hoverinfo>' + geography.properties.name + ' Zweitstimmenanteil: ' +
data.anteil+ ' Prozent' + ' ';
}  !#"
),
scope = 'states', height = 600 , width = 900 ,
setProjection = '#! function( element, options ) {
var projection, path;
projection = d3.geo.mercator()
.center([14, 51]).scale(10000)
.translate([element.offsetWidth / 2, element.offsetHeight / 2]);
path = d3.geo.path().projection( projection );
return {path: path, projection: projection};
} !#'
)
d1
gemeinden_ichoro_stack          <-  gemeinden_ichoro
gemeinden_ichoro_stack$name     <-  NULL
gemeinden_ichoro_stack          <-  reshape::melt(gemeinden_ichoro_stack , id=c("id" , "gemeinde"))
gemeinden_ichoro_stack$variable <-  factor(gemeinden_ichoro_stack$variable , labels=c("2013" , "2012" , "2011"))
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , year = variable)
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , anteil = value)
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , name = gemeinde)
gemeinden_ichoro_stack$name    <-  NULL
gemeinden_ichoro_stack$year     <-  as.character(gemeinden_ichoro_stack$year)
gemeinden_ichoro_stack$id       <-  as.character(gemeinden_ichoro_stack$id)
gemeinden_ichoro_stack          <-  gemeinden_ichoro_stack[order(gemeinden_ichoro_stack$name),]
#Darstellung auf der Karte
d1 <- ichoropleth(anteil ~ id , data = gemeinden_ichoro_stack , pal = 'YlOrRd' , ncuts = 5, map = "state" , animate = "year" , play = F)
d1$set(
geographyConfig = list(
dataUrl = "https://dl.dropboxusercontent.com/u/94863207/Gemeinden.json" ,
popupTemplate =  "#! function(geography, data) {
return '<div class=hoverinfo>' + geography.properties.name + ' Zweitstimmenanteil: ' +
data.anteil+ ' Prozent' + ' ';
}  !#"
),
scope = 'states', height = 600 , width = 900 ,
setProjection = '#! function( element, options ) {
var projection, path;
projection = d3.geo.mercator()
.center([14, 51]).scale(10000)
.translate([element.offsetWidth / 2, element.offsetHeight / 2]);
path = d3.geo.path().projection( projection );
return {path: path, projection: projection};
} !#'
)
d1
gemeinden_ichoro_stack          <-  gemeinden_ichoro
gemeinden_ichoro_stack$name     <-  NULL
gemeinden_ichoro_stack          <-  reshape::melt(gemeinden_ichoro_stack , id=c("id" , "gemeinde"))
gemeinden_ichoro_stack$variable <-  factor(gemeinden_ichoro_stack$variable , labels=c("2013" , "2012" , "2011"))
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , year = variable)
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , anteil = value)
gemeinden_ichoro_stack          <-  dplyr::rename(gemeinden_ichoro_stack , name = gemeinde)
gemeinden_ichoro_stack$name    <-  NULL
gemeinden_ichoro_stack$year     <-  as.integer(as.character(gemeinden_ichoro_stack$year))
gemeinden_ichoro_stack$id       <-  as.character(gemeinden_ichoro_stack$id)
gemeinden_ichoro_stack          <-  gemeinden_ichoro_stack[order(gemeinden_ichoro_stack$name),]
#Darstellung auf der Karte
d1 <- ichoropleth(anteil ~ id , data = gemeinden_ichoro_stack , pal = 'YlOrRd' , ncuts = 5, map = "state" , animate = "year" , play = F)
d1$set(
geographyConfig = list(
dataUrl = "https://dl.dropboxusercontent.com/u/94863207/Gemeinden.json" ,
popupTemplate =  "#! function(geography, data) {
return '<div class=hoverinfo>' + geography.properties.name + ' Zweitstimmenanteil: ' +
data.anteil+ ' Prozent' + ' ';
}  !#"
),
scope = 'states', height = 600 , width = 900 ,
setProjection = '#! function( element, options ) {
var projection, path;
projection = d3.geo.mercator()
.center([14, 51]).scale(10000)
.translate([element.offsetWidth / 2, element.offsetHeight / 2]);
path = d3.geo.path().projection( projection );
return {path: path, projection: projection};
} !#'
)
d1
setwd("C:/Users/User/Desktop")
sink("map.txt")
d1$show("inline" , include_assets = TRUE , cdn = TRUE)
sink()
library("slidify", lib.loc="~/R/win-library/3.1")
library("slidifyLibraries", lib.loc="~/R/win-library/3.1")
library("knitr", lib.loc="~/R/win-library/3.1")
author("reinhold")
detach("package:knitr", unload=TRUE)
library(slidify)
library("devtools", lib.loc="~/R/win-library/3.1")
install.github("slidify" , ramnathv)
install_github("slidify" , ramnathv)
install_github("slidify" , "ramnathv")
library(slidify)
author(dvpw)
author("dvpw")
author("dvpw")
install_github("ramnathv/slidify@fix-encode")
save.image("C:/Users/User/Desktop/example.RData")
slidifyDefaults()
